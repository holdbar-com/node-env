import { readFile } from 'node:fs/promises';
import { EOL } from 'node:os';
import { relative } from 'node:path';
import prettier from 'prettier';
export async function formatted(files) {
    const [options, ...src] = await Promise.all([
        prettier.resolveConfig(process.cwd()),
        ...files.map((file) => readFile(file)),
    ]);
    try {
        const bad = (await Promise.all(src.map(async (s, ix) => (await prettier.check(s.toString('utf8'), {
            ...options,
            filepath: files[ix],
        }))
            ? undefined
            : '  - ' + relative(process.cwd(), files[ix] ?? '')))).filter((file) => !!file);
        if (bad.length !== 0) {
            console.error('Improperly formatted:');
            console.error(bad.join(EOL));
            console.error('Consider using an editor with prettier support.');
            console.error();
            return false;
        }
        return true;
    }
    catch {
        return false;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZm9ybWF0dGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiZm9ybWF0dGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUM1QyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQzlCLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDckMsT0FBTyxRQUFRLE1BQU0sVUFBVSxDQUFDO0FBRWhDLE1BQU0sQ0FBQyxLQUFLLFVBQVUsU0FBUyxDQUFDLEtBQWU7SUFDN0MsTUFBTSxDQUFDLE9BQU8sRUFBRSxHQUFHLEdBQUcsQ0FBQyxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQztRQUMxQyxRQUFRLENBQUMsYUFBYSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUNyQyxHQUFHLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztLQUN2QyxDQUFDLENBQUM7SUFDSCxJQUFJLENBQUM7UUFDSCxNQUFNLEdBQUcsR0FBRyxDQUNWLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FDZixHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLEVBQUUsQ0FDdEIsQ0FBQyxNQUFNLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsRUFBRTtZQUN4QyxHQUFHLE9BQU87WUFDVixRQUFRLEVBQUUsS0FBSyxDQUFDLEVBQUUsQ0FBQztTQUNwQixDQUFDLENBQUM7WUFDRCxDQUFDLENBQUMsU0FBUztZQUNYLENBQUMsQ0FBQyxNQUFNLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsRUFBRSxLQUFLLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxDQUFDLENBQ3RELENBQ0YsQ0FDRixDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzNCLElBQUksR0FBRyxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUUsQ0FBQztZQUNyQixPQUFPLENBQUMsS0FBSyxDQUFDLHVCQUF1QixDQUFDLENBQUM7WUFDdkMsT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDN0IsT0FBTyxDQUFDLEtBQUssQ0FBQyxpREFBaUQsQ0FBQyxDQUFDO1lBQ2pFLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUNoQixPQUFPLEtBQUssQ0FBQztRQUNmLENBQUM7UUFDRCxPQUFPLElBQUksQ0FBQztJQUNkLENBQUM7SUFBQyxNQUFNLENBQUM7UUFDUCxPQUFPLEtBQUssQ0FBQztJQUNmLENBQUM7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcmVhZEZpbGUgfSBmcm9tICdub2RlOmZzL3Byb21pc2VzJztcbmltcG9ydCB7IEVPTCB9IGZyb20gJ25vZGU6b3MnO1xuaW1wb3J0IHsgcmVsYXRpdmUgfSBmcm9tICdub2RlOnBhdGgnO1xuaW1wb3J0IHByZXR0aWVyIGZyb20gJ3ByZXR0aWVyJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZvcm1hdHRlZChmaWxlczogc3RyaW5nW10pIHtcbiAgY29uc3QgW29wdGlvbnMsIC4uLnNyY10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgcHJldHRpZXIucmVzb2x2ZUNvbmZpZyhwcm9jZXNzLmN3ZCgpKSxcbiAgICAuLi5maWxlcy5tYXAoKGZpbGUpID0+IHJlYWRGaWxlKGZpbGUpKSxcbiAgXSk7XG4gIHRyeSB7XG4gICAgY29uc3QgYmFkID0gKFxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIHNyYy5tYXAoYXN5bmMgKHMsIGl4KSA9PlxuICAgICAgICAgIChhd2FpdCBwcmV0dGllci5jaGVjayhzLnRvU3RyaW5nKCd1dGY4JyksIHtcbiAgICAgICAgICAgIC4uLm9wdGlvbnMsXG4gICAgICAgICAgICBmaWxlcGF0aDogZmlsZXNbaXhdLFxuICAgICAgICAgIH0pKVxuICAgICAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgICAgIDogJyAgLSAnICsgcmVsYXRpdmUocHJvY2Vzcy5jd2QoKSwgZmlsZXNbaXhdID8/ICcnKVxuICAgICAgICApXG4gICAgICApXG4gICAgKS5maWx0ZXIoKGZpbGUpID0+ICEhZmlsZSk7XG4gICAgaWYgKGJhZC5sZW5ndGggIT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0ltcHJvcGVybHkgZm9ybWF0dGVkOicpO1xuICAgICAgY29uc29sZS5lcnJvcihiYWQuam9pbihFT0wpKTtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0NvbnNpZGVyIHVzaW5nIGFuIGVkaXRvciB3aXRoIHByZXR0aWVyIHN1cHBvcnQuJyk7XG4gICAgICBjb25zb2xlLmVycm9yKCk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiJdfQ==